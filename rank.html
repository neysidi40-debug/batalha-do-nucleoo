<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ranking de MCs</title>

<!-- Firebase -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import { 
    getFirestore, collection, getDocs, addDoc, updateDoc, deleteDoc, doc, onSnapshot 
} from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyAJopMM_tGohr8BQXZziVBt6UHWIz4dmNk",
  authDomain: "ranking-mcs.firebaseapp.com",
  projectId: "ranking-mcs",
  storageBucket: "ranking-mcs.firebasestorage.app",
  messagingSenderId: "137351607662",
  appId: "1:137351607662:web:daaa71f227902150f4bd7f"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

let admin = false;
let mcs = [];

async function carregarMCs() {
    onSnapshot(collection(db, "mcs"), (snapshot) => {
        mcs = [];
        snapshot.forEach(doc => {
            mcs.push({ id: doc.id, ...doc.data() });
        });

        atualizarRanking();
        if (admin) atualizarControle();
    });
}

window.loginAdmin = function () {
    const senha = prompt("Digite a senha de administrador:");
    if (senha === "nucleopass") {
        admin = true;
        document.getElementById("adminArea").style.display = "block";
        atualizarControle();
        alert("Login realizado com sucesso!");
    } else {
        alert("Senha incorreta!");
    }
};

window.alterarPonto = async function (i, valor) {
    const ref = doc(db, "mcs", mcs[i].id);
    await updateDoc(ref, { pontos: mcs[i].pontos + valor });
};

window.editar = async function (i) {
    const novo = prompt("Novo nome:", mcs[i].nome);
    if (novo) {
        await updateDoc(doc(db, "mcs", mcs[i].id), { nome: novo });
    }
};

window.remover = async function (i) {
    if (confirm("Excluir MC?")) {
        await deleteDoc(doc(db, "mcs", mcs[i].id));
    }
};

window.novoMC = async function () {
    const nome = prompt("Nome do novo MC:");
    if (!nome) return;
    await addDoc(collection(db, "mcs"), { nome, pontos: 0 });
};

// Atualiza rank
function atualizarRanking() {
    mcs.sort((a, b) => b.pontos - a.pontos);

    const tabela = document.getElementById("rankTable");
    tabela.innerHTML = `
    <tr><th>Posi√ß√£o</th><th>MC</th><th>Pontos</th></tr>`;

    mcs.forEach((mc, i) => {
        tabela.innerHTML += `
        <tr>
           <td>${i+1}¬∫</td>
           <td>${mc.nome}</td>
           <td>${mc.pontos}</td>
        </tr>`;
    });

    if (mcs.length > 0) {
        document.getElementById("painel").innerHTML =
            `ü•á <b>L√≠der:</b> ${mcs[0].nome}`;
    }
}

// Atualiza painel ADM
function atualizarControle() {
    const tabela = document.getElementById("controleTable");
    tabela.innerHTML = `
    <tr><th>MC</th><th>Pontos</th><th>A√ß√µes</th></tr>`;

    mcs.forEach((mc, i) => {
        tabela.innerHTML += `
        <tr>
          <td>${mc.nome}</td>
          <td>${mc.pontos}</td>
          <td>
            <button class="btn" onclick="alterarPonto(${i},0.5)">+0.5</button>
            <button class="btn" onclick="alterarPonto(${i},-0.5)">‚àí0.5</button>
            <button class="btn-edit btn" onclick="editar(${i})">Editar</button>
            <button class="btn-del btn" onclick="remover(${i})">Excluir</button>
          </td>
        </tr>`;
    });
}

carregarMCs();

</script>

<style>
 /* (todo o seu CSS ORIGINAL aqui, id√™ntico) */
</style>
</head>
<body>
<div class="container">
<h1>üèÜ Ranking de MCs</h1>

<div id="painel">Carregando...</div>

<table id="rankTable">
 <tr>
     <th>Posi√ß√£o</th>
     <th>MC</th>
     <th>Pontos</th>
 </tr>
</table>

<hr>

<button class="btn-add btn" onclick="loginAdmin()">üîê Login Admin</button>

<div id="adminArea" style="display:none;">
<h2>Gerenciar MCs</h2>
<table id="controleTable">
 <tr>
     <th>MC</th>
     <th>Pontos</th>
     <th>A√ß√µes</th>
 </tr>
</table>
<button class="btn-add btn" onclick="novoMC()">‚ûï Adicionar MC</button>
<div id="painelMC"></div>
</div>

</div>
</body>
</html>
