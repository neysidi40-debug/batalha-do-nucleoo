<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ranking de MCs</title>

<style>
body {
    margin: 0;
    font-family: Arial, sans-serif;
    background: url('fundo.jpg') no-repeat center center fixed;
    background-size: cover;
    color: white;
}
body::before {
    content: "";
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.65);
    backdrop-filter: blur(3px);
    z-index: -1;
}
.container {
    max-width: 450px;
    margin: 40px auto;
    background: rgba(0,0,0,0.7);
    padding: 20px;
    border-radius: 14px;
    border: 2px solid white;
    text-align: center;
}
table {
    width: 100%;
    border-collapse: collapse;
}
th, td {
    padding: 10px;
    border-bottom: 1px solid rgba(255,255,255,0.3);
}
th {
    background: rgba(255,255,255,0.15);
}
button {
    padding: 6px 10px;
    margin: 2px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    font-weight: bold;
}
.btn-add { background:#44ddff; color:black; }
.btn-edit { background:#ffaa00; }
.btn-del { background:#ff4444; color:white; }
.btn-p { background:#22cc88; }
.btn-m { background:#cc4444; color:white; }
#adminArea { display:none; }
#painel {
    margin-bottom: 10px;
    padding: 10px;
    background: rgba(255,255,255,0.1);
    border-radius: 8px;
}
</style>
</head>

<body>
<div class="container">
<h1>üèÜ Ranking de MCs</h1>

<div id="painel">Carregando...</div>

<table id="rankTable">
<tr><th>#</th><th>MC</th><th>Pontos</th></tr>
</table>

<hr>

<button class="btn-add" onclick="loginAdmin()">üîê Login Admin</button>

<div id="adminArea">
<h2>Gerenciar MCs</h2>

<table id="controleTable">
<tr><th>MC</th><th>Pontos</th><th>A√ß√µes</th></tr>
</table>

<button class="btn-add" onclick="novoMC()">‚ûï Adicionar MC</button>
</div>
</div>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbxL6GMOW-eJCKhzdYtWj1du5lYhsEkWiDkL3Z-aTvVfc9eFdd8NNZy69OfAJhSGZyDrhw/exec";

let admin = false;
let mcs = [];

async function carregarMCs() {
    const res = await fetch(API_URL);
    mcs = await res.json();
    atualizarRanking();
    if (admin) atualizarControle();
}

function loginAdmin() {
    const senha = prompt("Senha de administrador:");
    if (senha === "nucleopass") {
        admin = true;
        document.getElementById("adminArea").style.display = "block";
        atualizarControle();
        alert("Admin liberado");
    } else {
        alert("Senha incorreta");
    }
}

async function novoMC() {
    const nome = prompt("Nome do MC:");
    if (!nome) return;

    await fetch(API_URL, {
        method: "POST",
        body: JSON.stringify({ action:"add", nome })
    });
    carregarMCs();
}

async function alterarPonto(id, valor) {
    await fetch(API_URL, {
        method: "POST",
        body: JSON.stringify({ action:"pontos", id, valor })
    });
    carregarMCs();
}

async function editarMC(id, atual) {
    const nome = prompt("Novo nome:", atual);
    if (!nome) return;

    await fetch(API_URL, {
        method: "POST",
        body: JSON.stringify({ action:"edit", id, nome })
    });
    carregarMCs();
}

async function removerMC(id) {
    if (!confirm("Excluir MC?")) return;

    await fetch(API_URL, {
        method: "POST",
        body: JSON.stringify({ action:"delete", id })
    });
    carregarMCs();
}

function atualizarRanking() {
    mcs.sort((a,b)=>b.pontos - a.pontos);

    const t = document.getElementById("rankTable");
    t.innerHTML = "<tr><th>#</th><th>MC</th><th>Pontos</th></tr>";

    mcs.forEach((mc,i)=>{
        t.innerHTML += `
        <tr>
            <td>${i+1}</td>
            <td>${mc.nome}</td>
            <td>${mc.pontos}</td>
        </tr>`;
    });

    if (mcs.length) {
        document.getElementById("painel").innerHTML =
            `ü•á L√≠der: <b>${mcs[0].nome}</b>`;
    }
}

function atualizarControle() {
    const t = document.getElementById("controleTable");
    t.innerHTML = "<tr><th>MC</th><th>Pontos</th><th>A√ß√µes</th></tr>";

    mcs.forEach(mc=>{
        t.innerHTML += `
        <tr>
            <td>${mc.nome}</td>
            <td>${mc.pontos}</td>
            <td>
                <button class="btn-p" onclick="alterarPonto(${mc.id},0.5)">+0.5</button>
                <button class="btn-m" onclick="alterarPonto(${mc.id},-0.5)">-0.5</button>
                <button class="btn-edit" onclick="editarMC(${mc.id},'${mc.nome}')">Editar</button>
                <button class="btn-del" onclick="removerMC(${mc.id})">Excluir</button>
            </td>
        </tr>`;
    });
}

carregarMCs();
</script>
</body>
</html>
